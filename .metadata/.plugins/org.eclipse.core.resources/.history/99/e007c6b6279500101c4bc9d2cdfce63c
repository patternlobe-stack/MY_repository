
<%@page import="com.google.gson.Gson"%>
<%@page import="kr.or.ddit.member.vo.MemberVO"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
        

  
  <link rel="stylesheet" href="../css/board.css">
<script src="../js/jquery-3.7.1.js"></script>

<script src="../js/board.js"></script>

<%
	//로그인 상태 비교 
   MemberVO  vo =   (MemberVO)session.getAttribute("loginok");
   
   String user = null; //user라는 문자열 변수를 선언.

                                 //나중에 MemberVO 객체를 JSON 문자열로 변환해서 저장할 용도
   
   Gson  gson = new Gson();
   
                                    //Gson 라이브러리(Google JSON 라이브러리) 객체 생성.

                                    // Gson을 사용하면 자바 객체를 JSON 문자열로 변환하거나(JSON 직렬화), JSON을 자바 객체로 변환(JSON 역직렬화)할 수 있음.
  
   if(vo != null)  user= gson.toJson(vo); 
                                  //로그인한 사용자가 있으면(vo != null),

                                    //vo 객체를 Gson을 이용해 JSON 문자열로 변환 → user 변수에 저장

 /*  user= {
	  "mem_id"   : "a001" ,
	  "mem_pass" : "asdfasdf",
	  "mem_name" : "김은대"
    }
 */
%>


<%--
  //각 기능에 대한 이벤트 처리- 필요한 데이타(전송할데이타)를 구성한다 -
 //서버로 전송한다(board.js의 비동기 함수 - fetch() , ajax()를 이용하여 전송한다 )
 
 //controller 에서 클라이언트 요청 받음 - 
 -service 
 -dao 
 - mapper를 통해 db 수행
 
 //db에서 수행된 결과를 역으로 return 하고 controller에서  view페이지로 이동
 //view페이지에서 응답결과를 생성한다 - json형태 작성
 
 //서버로부터 응답결과를 받는다 
 -board.js의 비동기 함수 fetch()의 then(),  ajax()- success
 //응답받은 결과를 출력한다 
 
--%>

<script>
<%-- //uvo 변수 초기화
//- <%= %> 는 JSP에서 자바 값을 HTML/JS 코드로 출력하는 표현식
//- user != null ? user : "null"
//  → user 값이 null이 아니면 그대로 출력
//  → null이면 문자열 "null"을 출력
//- 즉, 로그인한 사용자가 있으면 JSON 문자열이 들어가고
//없으면 null 이 들어감 --%>
uvo = <%= user != null ? user : "null" %>; 

console.log("uvo====" , uvo);

currentPage = 1;

$(function(){
	
	ff = document.querySelector("#ff");

//본문요소의 id로 설정된 이름은 스크립트에서 전역변수처럼 직접 사용할 수 있다.
 //  - 이벤트 핸들러 들록 
    ff.addEventListener('submit',fn_listPageServer );
	
//처음 실행 - 이벤트 핸들러 실행
   ff.requestSubmit();

})
</script>

<!-- 댓글 수정폼  -->
 <div id="modifyform">
<textarea rows="5" cols="50"></textarea>
<input type="button" value="확인" id="btnok">
<input type="button" value="취소" id="btnreset">
</div>
 
  <br>
  <br>
   <nav class="navbar navbar-expand-sm navbar-dark bg-primary">
  <div class="container-fluid">
  <input type="button" id="write" value="글쓰기">
    <a class="navbar-brand" href="javascript:void(0)">Logo</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="mynavbar">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" href="javascript:void(0)">Link</a>
        </li>
       
      </ul>
   <!--  /  ff.page -->
      <form class="d-flex" id="ff">
      <input type="hidden" name="page" value="1" > 
      <select class="form-select" id="stype" name="stype">
		  <option value="">전체</option>
		  <option value="writer">작성자</option>
		  <option value="subject">제목</option>
		  <option value="content">내용</option>
	  </select>
      
        <input class="form-control me-2" type="text" id="sword" name="sword" placeholder="Search">
        <button id="search" class="btn btn-primary" type="submit">Search</button>
      </form>
    </div>
  </div>
</nav>
   
   <br><br>
   <!-- 리스트 3개씩을 출력 -->
   <div id="list"></div>
      <!-- //출력모양을 html코드로  미리 만들어놔도 됨
        비동기 처리 후 결과데이타만 출력하면됨-->
      <!-- 우리는 출력모양과 데이타출력을 비동기 처리 후   한꺼번에 함-->    
   <br>
   <br>
   
   <!-- 페이지정보를 출력  -->
   <div id="pagelist"></div>
  
<!------- 글쓰기   The Modal  ------- -->
<div class="modal" id="wModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">게시글 작성하기</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
       
       <form name="wfrom" id="wform">
            
            <label>이름</label>
            <input type="text" class="txt" id="writer" name="writer"> <br> 
            
            <label>제목</label>
            <input type="text" class="txt" id="subject" name="subject"> <br> 
            
            <label>메일</label>
            <input type="text"  class="txt" id="mail" name="mail"> <br> 
            
            <label>비밀번호</label>
            <input type="password"  class="txt" id="password"   name="password"> <br> 
            
            <label>내용</label>
            <br>
            <textarea rows="5" cols="40"  class="txt" id="content"  name="content"></textarea>
            <br>
            <br>
            <input type="button" value="전송" id="send">
        </form>
       
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>
  
  
<!----- 글 수정  The Modal    ----->
<div class="modal" id="uModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">게시글 수정하기</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
       
       <form name="ufrom" id="uform">
          
            <input type="hidden" id="unum" name="num">
            <label>이름</label>
            <input type="text" class="txt" id="uwriter" name="writer"> <br> 
            
            <label>제목</label>
            <input type="text" class="txt" id="usubject" name="subject"> <br> 
            
            <label>메일</label>
            <input type="text"  class="txt" id="umail" name="mail"> <br> 
            
            <label>비밀번호</label>
            <input type="password"  class="txt" id="upassword"   name="password"> <br> 
            
            <label>내용</label>
            <br>
            <textarea rows="5" cols="40"  class="txt" id="ucontent"  name="content"></textarea>
            <br>
            <br>
            <input type="button" value="전송" id="usend">
        </form>
       
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>
  







