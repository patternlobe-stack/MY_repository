<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet"  href="../css/public.css">

<script>
const proc1 = () =>{
	//입력한 값을 가져오기 
	vid = document.querySelector('#gid').value;
	vname = document.querySelector('#gname').value;
	vmail = document.querySelector('#gemail').value;
	
	fetch("fetch_get.jsp?id=" + vid + "&name=" + vname + "&mail=" + vmail )
	.then( res=>{
		//res는 Response객체 - 실제 응답 json데이타가 포함되어 있지 ㅇ않다 
		console.log(res);
		
		if(res.ok)  return res.json();  // 응답데이타를 역직렬화 - javascript객체로 뱐환 
	})
	.then( data =>{
		
		code = "아이디 " + data['id'] + "<br>";
		code += `이름 ${data['name']} <br>`;
		code += `이메일${data['mail']} <br>`;
		
		document.querySelector("#result1").innerHTML = code ;
	})
	.catch(err=> console.log(err))

}

const getData = (url, had, senddata) =>{
	
	fetch(url, {
		method : "post",
		headers : had ,
		body :  senddata
	})
	.then( res =>{
		//Response객체의 json()메소드를 가지고 역직렬화 한다 
		//json 형식의 문자열을 script객체로 변환 
		if(res.ok) return res.json();
	})
	.then( data=>{
		code = "아이디 " + data['id'] + "<br>";
		code += `이름 ${data['name']} <br>`;
		code += `이메일${data['mail']} <br>`;
		
		document.querySelector("#result2").innerHTML = code ;
	})
	.catch(err=> console.log(err))
	
}
const proc2 = () =>{
	
	//입력한 값을 가져오기 
	vid = document.querySelector('#pid').value;
	vname = document.querySelector('#pname').value;
	vmail = document.querySelector('#pemail').value;
	
	send = "id=" + vid + "&name=" + vname + "&mail=" + vmail;
	head = { "content-type" : "application/x-www-form-urlencoded"  }

	getData("fetch_params.jsp",  head, send)
	
}

const proc3 = () =>{
	//입력한 값을 가져오기 
	vid = document.querySelector('#pid').value;
	vname = document.querySelector('#pname').value;
	vmail = document.querySelector('#pemail').value;
	
	send=  JSON.stringify({id : vid , name : vname , mail : vmail});
	head = { "content-type" : "application/json;charset=utf-8"  } ;
	
	getData("fetch_serial.jsp",  head, send)
}






</script>

<script>
</script>

</head>
<body>


<div class="box">
      <h3>
      </h3>
      <input type="text" placeholder="아이디 입력"  id="gid"><br>
      <input type="text"  placeholder="이름입력" id="gname"><br>
      <input type="text"  placeholder="이메일입력" id="gemail"><br>
      <input type="button" value="get" onclick="proc1()" />
      <br /><br />

      <div id="result1"></div>
</div>

<div class="box">
      <h3>
      </h3>
      
      <input type="text" placeholder="아이디 입력"  id="pid"><br>
      <input type="text"  placeholder="이름입력" id="pname"><br>
      <input type="text"  placeholder="이메일입력" id="pemail"><br>
      
      <input type="button" value="post_params" onclick="proc2()" />
       <input type="button" value="post_serial" onclick="proc3()" />
      <br /><br />

      <div id="result2"></div>
</div>




</body>
</html>